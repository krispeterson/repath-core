# RePath Core Runtime Release Contract

This document defines the runtime artifact contract for `repath-core` releases.

## Required runtime content

The runtime data payload must include only:
- `packages/packs/*/pack.json`
- `schema/pack.schema.json`
- `dist/manifest.json`
- `dist/search.json`

## Required release assets

Each tagged runtime release should publish:
- `repath-core-vX.Y.Z-runtime-data.tar.gz`
- `repath-core-vX.Y.Z-runtime-data.sha256`
- `repath-core-vX.Y.Z-runtime-data.files.sha256`

`*.sha256` is the archive checksum.

`*.files.sha256` contains per-file checksums for files inside the bundle root.

## Manifest URL policy

`dist/manifest.json` `url` values are generated by `tools/manifest-build.js`.

- Default behavior (no override): local repo-relative paths (`packages/packs/<pack-id>/pack.json`)
- Release/deploy behavior: pass a real hosted base URL via `REPATH_PACK_BASE_URL`

Example:
```bash
REPATH_PACK_BASE_URL=https://cdn.example.com/packs npm run build:manifest
```

This produces per-pack URLs like:
`https://cdn.example.com/packs/<pack-id>.json`

## Reproducible release command

Use:
```bash
npm run release:runtime -- --tag vX.Y.Z --pack-base-url https://cdn.example.com/packs
```

What it does:
1. Builds `dist/manifest.json` + `dist/search.json`
2. Validates packs
3. Runs smoke checks
4. Creates runtime archive and checksum files
